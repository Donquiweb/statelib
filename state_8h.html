<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>State Library: /home/allali/PROJETS/tmp/statelib/src/state.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">State Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('state_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">state.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>state library api  
<a href="#details">More...</a></p>

<p><a href="state_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a64e47a499adba9f8e97fa978a2c3b55b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a64e47a499adba9f8e97fa978a2c3b55b"></a>
typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a> )(void *data)</td></tr>
<tr class="memdesc:a64e47a499adba9f8e97fa978a2c3b55b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default type for a state function. <br /></td></tr>
<tr class="separator:a64e47a499adba9f8e97fa978a2c3b55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a28f1067435a503a6bc373b20bfc304fc"><td class="memItemLeft" align="right" valign="top">struct StateMachine *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a28f1067435a503a6bc373b20bfc304fc">state_newmachine</a> ()</td></tr>
<tr class="memdesc:a28f1067435a503a6bc373b20bfc304fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">state_newmachine instanciate a new empty machine  <a href="#a28f1067435a503a6bc373b20bfc304fc">More...</a><br /></td></tr>
<tr class="separator:a28f1067435a503a6bc373b20bfc304fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4fedc75e9b6c71817af45a769769fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#abc4fedc75e9b6c71817af45a769769fd">state_free</a> (struct StateMachine *p)</td></tr>
<tr class="memdesc:abc4fedc75e9b6c71817af45a769769fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">state_free release resource of a machine allocated with state_newmachine  <a href="#abc4fedc75e9b6c71817af45a769769fd">More...</a><br /></td></tr>
<tr class="separator:abc4fedc75e9b6c71817af45a769769fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f3f16e584fe2ceb494059db3a1eedd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a8f3f16e584fe2ceb494059db3a1eedd4">state_add_transition</a> (struct StateMachine *machine, <a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a> from, int value, <a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a> to)</td></tr>
<tr class="memdesc:a8f3f16e584fe2ceb494059db3a1eedd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">state_add_transition Add a new transition into the machine  <a href="#a8f3f16e584fe2ceb494059db3a1eedd4">More...</a><br /></td></tr>
<tr class="separator:a8f3f16e584fe2ceb494059db3a1eedd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33604bf72b994e771f0e5638bf17c343"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a33604bf72b994e771f0e5638bf17c343">state_start</a> (struct StateMachine *machine, <a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a> start, void *data)</td></tr>
<tr class="memdesc:a33604bf72b994e771f0e5638bf17c343"><td class="mdescLeft">&#160;</td><td class="mdescRight">state_start run a state machine  <a href="#a33604bf72b994e771f0e5638bf17c343">More...</a><br /></td></tr>
<tr class="separator:a33604bf72b994e771f0e5638bf17c343"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>state library api </p>
<p>The state library is really simple. First you must create a machine using the state_newmachine function. This will return an handler to an empty machine. Then you can register any state and transition using state_add_transition function. A state is a pointer to a function, transition are associated to int. State return value are used to select the next state function that will be run. Finally, you can start your machine by giving the initial state function and a pointer that will be passed to all state function. At last, release the resources associated to the machine using state_free.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="state_8h.html">state.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> a(<span class="keywordtype">void</span> *p){</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">int</span> counter=0;</div>
<div class="line">  counter+=1;</div>
<div class="line">  printf(<span class="stringliteral">&quot;a: %d\n&quot;</span>,counter);</div>
<div class="line">  <span class="keywordflow">return</span> counter;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> b(<span class="keywordtype">void</span> *p){</div>
<div class="line">  printf(<span class="stringliteral">&quot;b\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(){</div>
<div class="line">  <span class="keyword">struct </span>StateMachine *machine;</div>
<div class="line">  machine=<a class="code" href="state_8h.html#a28f1067435a503a6bc373b20bfc304fc">state_newmachine</a>();</div>
<div class="line">  <a class="code" href="state_8h.html#a8f3f16e584fe2ceb494059db3a1eedd4">state_add_transition</a>(machine,a,1,b);</div>
<div class="line">  <a class="code" href="state_8h.html#a8f3f16e584fe2ceb494059db3a1eedd4">state_add_transition</a>(machine,b,0,a);</div>
<div class="line">  <a class="code" href="state_8h.html#a8f3f16e584fe2ceb494059db3a1eedd4">state_add_transition</a>(machine,a,2,NULL);</div>
<div class="line">  <a class="code" href="state_8h.html#a33604bf72b994e771f0e5638bf17c343">state_start</a>(machine,a,NULL);</div>
<div class="line">  <a class="code" href="state_8h.html#abc4fedc75e9b6c71817af45a769769fd">state_free</a>(machine);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8f3f16e584fe2ceb494059db3a1eedd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int state_add_transition </td>
          <td>(</td>
          <td class="paramtype">struct StateMachine *&#160;</td>
          <td class="paramname"><em>machine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a>&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a>&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>state_add_transition Add a new transition into the machine </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machine</td><td>a pointer obtained with state_newmachine </td></tr>
    <tr><td class="paramname">from</td><td>the current machine state </td></tr>
    <tr><td class="paramname">value</td><td>the value return by from </td></tr>
    <tr><td class="paramname">to</td><td>the state run after from, NULL if the machine must exit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if no error, 1 if memory error, 2 if transition already in machine </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="basic_8c-example.html#a1">basic.c</a>, and <a class="el" href="demo_menu_8c-example.html#a1">demo_menu.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="abc4fedc75e9b6c71817af45a769769fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void state_free </td>
          <td>(</td>
          <td class="paramtype">struct StateMachine *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>state_free release resource of a machine allocated with state_newmachine </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>a pointer returned by state_newmachine </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="basic_8c-example.html#a3">basic.c</a>, and <a class="el" href="demo_menu_8c-example.html#a3">demo_menu.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a28f1067435a503a6bc373b20bfc304fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct StateMachine* state_newmachine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>state_newmachine instanciate a new empty machine </p>
<dl class="section return"><dt>Returns</dt><dd>NULL if error, a pointer that must be release with state_free </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="basic_8c-example.html#a0">basic.c</a>, and <a class="el" href="demo_menu_8c-example.html#a0">demo_menu.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a33604bf72b994e771f0e5638bf17c343"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int state_start </td>
          <td>(</td>
          <td class="paramtype">struct StateMachine *&#160;</td>
          <td class="paramname"><em>machine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="state_8h.html#a64e47a499adba9f8e97fa978a2c3b55b">StateFunc</a>&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>state_start run a state machine </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">machine</td><td>a pointer to the state machine </td></tr>
    <tr><td class="paramname">start</td><td>the first state that will be run </td></tr>
    <tr><td class="paramname">data</td><td>a pointer that will be passed to all states </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the return value of the last state run </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="basic_8c-example.html#a2">basic.c</a>, and <a class="el" href="demo_menu_8c-example.html#a2">demo_menu.c</a>.</dd>
</dl>
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="state_8h.html">state.h</a></li>
    <li class="footer">Generated on Tue Feb 10 2015 17:22:17 for State Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
